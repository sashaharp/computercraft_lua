---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Sasha Harp.
--- DateTime: 026, 8/26/21 10:27 PM
---

function setLocalCoords(x, y, z)
    local f
    local data
    if not fs.exists('/data/') then
        fs.makeDir('/data')
        data = {}
        data.localCoords = {}
        data.localCoords.x=x
        data.localCoords.y=y
        data.localCoords.z=z
        f = fs.open('/data/local', 'w')
        f.write(textutils.serialize(data))
        f.close()
        return
    end
    f = fs.open('/data/local', 'r')
    data = textutils.unserialize(f.readAll())
    data.localCoords = {}
    data.localCoords.x=x
    data.localCoords.y=y
    data.localCoords.z=z
    f.close()
    f = fs.open('/data/local', 'w')
    f.write(textutils.serialize(data))
    f.close()
end

function getLocalCoords()
    local data
    if fs.exists('/data/local') then
        local f = fs.open('/data/local', 'r')
        data = textutils.unserialize(f.readAll())
        f.close()
    end
    return data.localCoords
end

function localMove(x, y, z)
    b = true
    for i=1, math.abs(x), 1 do
        if x > 0 then b = turtle.forward() else b = turtle.back() end
        if not b then
            moveLocalCoords(i-1, 0, 0)
            return false
        end
    end
    turtle.turnRight()
    for i=1, math.abs(y), 1 do
        if y > 0 then b = turtle.forward() else b = turtle.back() end
        if not b then
            moveLocalCoords(x, i-1, 0)
            return false
        end
    end
    turtle.turnLeft()
    for i=1, math.abs(z), 1 do
        if z > 0 then b = turtle.up() else b = turtle.down() end
        if not b then
            moveLocalCoords(x, y, i-1)
            return false
        end
    end
    moveLocalCoords(x, y, z)
    return true
end

function moveLocalCoords(x, y, z)
    coords = getLocalCoords()
    setLocalCoords(coords.x + x, coords.y + y, coords.z + z)
end

funcs = {}
funcs['setLocalCoords'] = setLocalCoords
funcs['getLocalCoords'] = getLocalCoords
funcs['localMove'] = localMove
